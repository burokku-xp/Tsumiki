# Design: Display Features

## Context

計測データをVSCodeのプライマリーサイドバー（エクスプローラー、検索、ソース管理などが表示される場所）で表示します。WebViewとReactを使用して、自由なレイアウトでダッシュボード形式のUIを提供します。

## Goals / Non-Goals

### Goals
- 日次サマリーの表示（作業時間、保存回数、ファイル数、変更行数、言語比率、編集ファイル一覧）
- リアルタイム更新（計測データの変更を即座に反映）
- シンプルで見やすいUI
- 参考値としての行数表示（信頼性の明示）

### Non-Goals
- 複雑なグラフ表示（v1ではリスト形式）
- 過去データの表示（v1では当日のみ）
- カスタマイズ可能なUI（v2以降）

## Decisions

### Decision: WebView + Reactを使用
- **理由**: 自由なレイアウトが可能、カード形式やプログレスバーなどの豊富なUI表現、コンポーネントベースの開発、プライマリーサイドバーに配置可能（`type: "webview"`）
- **代替案**: TreeView API（表現力が限定的、ツリー形式のみ）、純粋なHTML/CSS/JS（開発効率が低い）

### Decision: postMessageによる通信
- **理由**: WebViewと拡張機能本体間の標準的な通信方法
- **代替案**: なし（VSCode APIの標準）

### Decision: リアルタイム更新を実装
- **理由**: ユーザーが最新の状態を常に確認できる
- **実装方法**: 計測データ変更時に拡張機能からWebViewへ通知

### Decision: 言語比率はリスト形式で表示
- **理由**: シンプルで実装が容易、円グラフはv2以降で検討
- **代替案**: 円グラフ（ライブラリが必要、複雑）

## Risks / Trade-offs

- **リスク**: WebViewのパフォーマンス（大量データ表示時）
- **対策**: 仮想スクロール、ページネーション（将来実装）

- **リスク**: Reactアプリのバンドルサイズ
- **対策**: コード分割、不要なライブラリの排除

- **リスク**: 通信の複雑性
- **対策**: 明確なメッセージプロトコル定義、エラーハンドリング

## Migration Plan

新規機能のため、マイグレーションは不要です。

## UI Design Details

### Layout Structure

```
┌─────────────────────────────────┐
│  🧱 本日の記録                  │
├─────────────────────────────────┤
│                                 │
│  ⏱️ 作業時間                    │
│  3時間12分                      │
│                                 │
│  💾 保存回数                     │
│  24回                           │
│                                 │
│  📁 編集ファイル数               │
│  8ファイル                      │
│                                 │
│  📝 変更行数                     │
│  187行 (参考値)                 │
│                                 │
│  💻 言語比率                     │
│  TypeScript  65%                │
│  CSS         20%                │
│  JavaScript  10%                │
│  Other        5%                │
│                                 │
│  📄 編集ファイル一覧             │
│  ┌───────────────────────────┐ │
│  │ src/components/Login.tsx  │ │
│  │ 42行                      │ │
│  ├───────────────────────────┤ │
│  │ src/hooks/useAuth.ts      │ │
│  │ 28行                      │ │
│  ├───────────────────────────┤ │
│  │ src/styles/login.css      │ │
│  │ 35行                      │ │
│  ├───────────────────────────┤ │
│  │ ... 他5ファイル           │ │
│  └───────────────────────────┘ │
│                                 │
└─────────────────────────────────┘
```

### Visual Design Principles

1. **VSCodeテーマ統合**
   - VSCodeのカラーテーマ（ダーク/ライト）に自動適応
   - `vscode.getColorTheme()`を使用してテーマを取得
   - CSS変数でテーマカラーを適用

2. **情報階層**
   - ヘッダー: タイトル「🧱 本日の記録」
   - 主要指標: カード形式で強調表示（作業時間、保存回数、ファイル数）
   - 詳細情報: セクション形式（変更行数、言語比率）
   - リスト: スクロール可能な編集ファイル一覧

3. **視覚的要素**
   - アイコン/絵文字で各セクションを識別しやすく
   - 数値は大きく表示して視認性向上
   - セクション間に適切なスペーシング
   - 参考値ラベルは控えめな色で表示
   - 言語比率はプログレスバーで視覚化

4. **レスポンシブ対応**
   - サイドパネルの幅に応じてレイアウト調整
   - ファイル一覧は最大10件表示、それ以上は「... 他Nファイル」で省略
   - スクロール可能な領域を明確に表示

### Component Structure

```
App
├── Header (タイトル)
├── StatsSection
│   ├── WorkTimeCard (作業時間)
│   ├── SaveCountCard (保存回数)
│   └── FileCountCard (編集ファイル数)
├── DetailsSection
│   ├── LineChangesCard (変更行数)
│   └── LanguageRatioCard (言語比率 - プログレスバー)
└── FileListSection
    └── FileList (編集ファイル一覧)
```

### Color Scheme

- **背景**: VSCodeテーマの背景色に合わせる
- **カード背景**: セクション背景より少し明るい/暗い色
- **テキスト**: VSCodeテーマのテキスト色
- **アクセント**: VSCodeのアクセントカラー（リンク色など）
- **参考値ラベル**: グレー系の控えめな色

### Typography

- **タイトル**: 18-20px、太字
- **主要数値**: 24-28px、太字
- **ラベル**: 12-14px、通常
- **ファイル名**: 13-14px、等幅フォント推奨
- **行数**: 12px、グレー系

### Interaction States

- **ローディング**: スケルトンUIまたはスピナー表示
- **データなし**: 「本日のデータはありません」メッセージ
- **更新中**: アニメーション（フェードイン/アウト）で更新を視覚化
- **エラー**: エラーメッセージを表示

### Accessibility

- セマンティックHTMLを使用
- 適切なコントラスト比を確保
- キーボードナビゲーション対応（必要に応じて）
- スクリーンリーダー対応（aria-labelなど）

## Open Questions

- 過去データの表示方法（v2以降で検討）
