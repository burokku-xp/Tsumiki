# OpenSpec連携ガイド

## 概要

OpenSpecはコードレビューと承認プロセスを管理するツール。GitHubのプルリクエストと連携して、コードレビューの品質を向上させる。

## OpenSpecレビューフロー

### 1. プルリクエスト作成後の手順

#### 1.1 OpenSpecにレビューを登録

1. OpenSpecのダッシュボードにアクセス
2. 「新しいレビュー」ボタンをクリック
3. 以下の情報を入力：
   - **PR URL**: GitHubのプルリクエストURL
   - **ブランチ名**: レビュー対象のブランチ名
   - **タイトル**: PRのタイトルと同じか、簡潔な説明
   - **説明**: PRの説明をコピーまたは要約
   - **レビュアー**: コードレビューを依頼するメンバーを選択

#### 1.2 レビュー設定

- **レビュー種別**: 通常レビュー / 緊急レビュー / 簡易レビュー
- **必須承認数**: マージに必要な承認者の数
- **自動通知**: レビュー開始時にレビュアーに通知するか

### 2. コードレビューの実施

#### 2.1 レビュアーの作業

1. OpenSpecからレビュー依頼の通知を受け取る
2. OpenSpecのレビュー画面でコードを確認
3. 以下の観点でレビューを実施：
   - **コード品質**: 可読性、保守性、パフォーマンス
   - **設計**: アーキテクチャ、設計パターン
   - **テスト**: テストカバレッジ、テストの品質
   - **セキュリティ**: セキュリティ上の問題
   - **ドキュメント**: コメント、READMEの更新

#### 2.2 コメントの記録

OpenSpec上でコメントを記録：

- **指摘事項**: 改善が必要な点
- **質問**: 理解を深めるための質問
- **提案**: より良い実装方法の提案
- **承認**: 問題なしと判断した場合

#### 2.3 レビュー結果の判定

- **承認**: 問題なくマージ可能
- **条件付き承認**: 軽微な修正後に承認
- **却下**: 重大な問題があり、修正が必要

### 3. レビュー結果の反映

#### 3.1 承認された場合

1. OpenSpecで承認が完了したことを確認
2. GitHubのPRにOpenSpecのレビュー結果をコメントで共有
3. マージの準備が整ったことを確認

#### 3.2 修正が必要な場合

1. OpenSpecのコメントを確認
2. 指摘事項に対応する修正を実施
3. 修正をコミットしてプッシュ
4. OpenSpecで再レビューを依頼

```bash
# 修正をコミット
git add .
git commit -m "fix: Address review comments"

# プッシュ
git push origin feature/機能名
```

#### 3.3 再レビューの依頼

1. OpenSpecで「再レビュー依頼」をクリック
2. 修正内容を説明するコメントを追加
3. レビュアーに通知が送信される

### 4. マージ前の最終確認

OpenSpecで以下の確認を行う：

- [ ] すべての必須レビュアーからの承認が得られている
- [ ] すべての指摘事項に対応済み
- [ ] 再レビューが必要な場合は完了している
- [ ] CI/CDパイプラインが成功している

## OpenSpecの機能活用

### レビューコメントの管理

- OpenSpec上でコメントを一元管理
- GitHubのPRコメントと同期
- コメントの解決状況を追跡

### レビュー履歴の確認

- 過去のレビュー履歴を確認
- レビューの傾向を分析
- レビュー時間の把握

### 自動通知

- レビュー依頼時の通知
- レビュー完了時の通知
- コメント追加時の通知

## ベストプラクティス

### レビュー依頼時

- PR作成後は即座にOpenSpecレビューを開始
- PRの説明を充実させて、レビュアーの理解を助ける
- 適切なレビュアーを選択（ドメイン知識を持つメンバー）

### レビュー実施時

- 建設的なフィードバックを提供
- コードの意図を理解してからコメント
- 小さな問題は指摘しつつも、大きな問題に焦点を当てる

### 修正対応時

- レビューコメントには迅速に対応
- 修正内容を明確に説明
- 対応できない場合は理由を説明

## トラブルシューティング

### OpenSpecにPRが連携されない

1. PRのURLが正しいか確認
2. OpenSpecの設定でGitHub連携が有効か確認
3. ブランチ名が正しいか確認

### レビューコメントがGitHubに反映されない

1. OpenSpecとGitHubの連携設定を確認
2. 手動でGitHubのPRにコメントを追加
3. OpenSpecのサポートに問い合わせ

### 承認が完了しているのにマージできない

1. 必須承認数が満たされているか確認
2. CI/CDパイプラインの状態を確認
3. ブランチ保護ルールを確認

## 参考リンク

- OpenSpec公式ドキュメント: [URL]
- GitHub連携設定: [URL]
- レビューベストプラクティス: [URL]
